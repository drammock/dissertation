% !TEX TS-program = xelatex
% !TEX encoding = UTF-8
\documentclass[12pt,oneside]{report}
\usepackage[letterpaper, margin=1in]{geometry} % smaller margins
\usepackage[nottoc,notlof,notlot,chapter]{tocbibind} % adds entries for the list of figs, list of tables, and bib to the TOC
\usepackage[titletoc]{appendix} % adds "Appendix" before the appendix letter in TOC
\usepackage[parfill]{parskip} % begin paragraphs with empty line, not an indent
\usepackage[compact]{titlesec}
%\usepackage{fancyhdr} \pagestyle{fancy} \fancyhf{} %\lhead[]{} \chead[]{} \rhead[]{} \lfoot[]{} \cfoot[]{\fancyplain{}{\osf \thepage}} \rfoot[]{}  %\cmd[oddpage]{evenpage}
\usepackage{natbib, graphicx, color, url, fontspec, ragged2e, setspace, paralist, float, array, longtable, tabu, booktabs, multicol, multirow, titling, etoolbox}  % \setuldepth{x} tabularx, siunitx, 
\usepackage[hidelinks,pdfpagelabels,xetex]{hyperref}
\hypersetup{
    pdftitle={Prosody, familiarity and intelligibility in speech perception},
    pdfauthor={Daniel R. McCloy},
    pdfsubject={Linguistics},
    pdfkeywords={phonetics, speech perception, prosody, intelligibility, familiarity},
    bookmarksnumbered=true,
    bookmarksopen=true,
    bookmarksopenlevel=1,
    colorlinks=false,
    pdfstartview=Fit,
    pdfpagemode=UseOutlines,
    unicode=true,
}

% prevent bibitems from splitting across pages (requires etoolbox package)
\AtBeginEnvironment{thebibliography}{\interlinepenalty10000}

% setup handling of code listings
\usepackage{caption}
\newenvironment{code}{\captionsetup{type=listing}\bigskip\noindent}{\bigskip}
\usepackage[chapter]{minted} 
\usemintedstyle{default}
\renewcommand\listingscaption{Script}
\renewcommand\listoflistingscaption{List of Scripts}
\renewcommand{\listoflistings}{%
	\cleardoublepage
	\addcontentsline{toc}{section}{\listoflistingscaption}%
	\listof{listing}{\listoflistingscaption}%
}

% TOC stuff: hack the other lists to appear in the TOC as sections (even though they're formatted as chapters in the document)
\renewcommand{\contentsname}{\bfseries\LARGE{Table of Contents}}
\renewcommand{\listoftables}{%
	\cleardoublepage
	\addcontentsline{toc}{section}{\listtablename}%
	\listof{table}{\listtablename}%
}
\renewcommand{\listoffigures}{%
	\cleardoublepage
	\addcontentsline{toc}{section}{\listfigurename}%
	\listof{figure}{\listfigurename}%
}


% comments, common abbreviations, etc
\definecolor{ltgray}{gray}{0.7}
\newcommand{\comment}[1]{{\textcolor{red}{(#1)}}}
\newcommand{\exclude}[1]{}
\newcommand{\term}[1]{“#1”} % first occurrence of technical terms
\newcommand{\ac}[1]{\textsc{#1}} % acronyms % \newcommand{\ac}[1]{\MakeUppercase{#1}}
\newcommand{\lat}[1]{\textit{#1}} % foreign words and abbreviations
\newcommand{\fo}{ƒ₀}
\newcommand{\eg}{\lat{e.g.}}
\newcommand{\ie}{\lat{i.e.}}
\newcommand{\viz}{\lat{viz.}}
\newcommand{\etseq}{\lat{et seq.}}
\newcommand{\intal}{\lat{inter alia}}
\newcommand{\aka}{\textsc{aka}}
\newcommand{\vs}{\lat{vs.}}

% fonts & formatting
\setmainfont[Numbers={Lining}]{Linux Libertine O} \setmonofont{M+ 1m medium} %\setmonofont{Linux Libertine Mono O}
\renewcommand{\url}{\begingroup \def\UrlLeft{}\def\UrlRight{}\urlstyle{same}\Url} % set URLs in whatever font surrounding text uses

% itemized lists
\renewcommand{\labelitemi}{•} \renewcommand{\labelitemii}{◦} \renewcommand{\labelitemiii}{—} % redefine default bullets
\newenvironment{itm}{% just like itemize, but with bullets flush left with surrounding text
	\setlength{\leftmargini}{0.5em}%
	\setlength{\leftmarginii}{1em}%
	\setlength{\leftmarginiii}{1.5em}%
	\begin{itemize}}{\end{itemize}%
}

% formatting for section & subsection headings and table captions
\titleformat{\chapter}{\LARGE\bfseries\doublespacing}{Chapter \thechapter.}{0.6em}{}
\titlespacing*{\chapter}{0pt}{-50pt}{*0} % -50pt is a hack to undo the default (which for \chapter won't be undone by just using *0)
\titlespacing*{\section}{0pt}{*0}{*0}
\titlespacing*{\subsection}{0pt}{*0}{*0}
\titlespacing*{\subsubsection}{0pt}{*0}{*0}

% table caption related tweaks
\setlength{\LTcapwidth}{\textwidth} % longtables only
\setlength{\extrarowsep}{0.1em}

% hack the abstract name
\renewcommand{\abstractname}{
	\normalfont
	\begin{spacing}{1}
	\begin{centering}
	University of Washington\\ \vskip 2em%
	\textbf{Abstract}\\ \vskip 2em%
	\thetitle \\ \vskip 2em%
	\theauthor \vskip 2em%
	Chair of the Supervisory Committee:\\Professor Richard A. Wright\\Department of Linguistics \vskip 2em%
	\end{centering}
	\end{spacing}
}

\title{Prosody, familiarity and intelligibility in speech perception}
\author{Daniel~Robert~McCloy}
\date{2013}
\begin{document}
\RaggedRight
\begin{spacing}{2}

\exclude{
% TITLE PAGE & ABSTRACT
\input{00a_tit_abs}
% FRONTMATTER
\pagenumbering{roman}
\tableofcontents
\listoffigures
\listoftables
\listoflistings
% ACKNOWLEDGMENTS & DEDICATION
\cleardoublepage
\addcontentsline{toc}{section}{Acknowledgments}
\input{00b_ackn}
\cleardoublepage
\addcontentsline{toc}{section}{Dedication}
\input{00c_ded}
\cleardoublepage
}
% MAIN CONTENT
%\pagenumbering{arabic}
\input{01_introduction}
\input{02_background}
\input{03_questions}
\input{04_methods}
\input{05_results}
\input{06_discussion}
\end{spacing}

% BIBLIOGRAPHY (SINGLE SPACED)
\bibliographystyle{apa-custom}
\bibliography{dissertation}

%\appendix
\titleformat{\chapter}{\LARGE\bfseries\doublespacing}{Appendix \thechapter.}{0.6em}{}
\begin{appendices}
\input{apx_HarvardSents}
\input{apx_PraatScripts}
\end{appendices}
\end{document}
